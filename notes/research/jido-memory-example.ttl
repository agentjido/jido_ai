@prefix jmem: <https://w3id.org/jido/memory/core#> .
@prefix ex:   <https://example.org/memory/jido-elixir#> .
@prefix xsd:  <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .

#################################################################
# Contexts
#################################################################

ex:global-context
  a jmem:GlobalContext ;
  rdfs:label "Global developer profile" ;
  jmem:createdAt "2026-01-05T10:00:00Z"^^xsd:dateTime .

ex:session-001
  a jmem:SessionContext ;
  rdfs:label "Work session — implement JidoMemory.SHACLValidator in Elixir" ;
  jmem:createdAt "2026-01-05T11:00:00Z"^^xsd:dateTime .

ex:task-001
  a jmem:TaskContext ;
  rdfs:label "Add SHACL validation pipeline to JidoMemory application" ;
  jmem:createdAt "2026-01-05T11:05:00Z"^^xsd:dateTime .

#################################################################
# Entities (actual Elixir things)
#################################################################

ex:user-pascal
  a jmem:Entity ;
  rdfs:label "Pascal Charbonneau" .

ex:project-jido-memory
  a jmem:Entity ;
  rdfs:label "Elixir project JidoMemory" .

ex:module-jido-memory-shacl-validator
  a jmem:Entity ;
  rdfs:label "Elixir module JidoMemory.SHACLValidator" .

ex:test-module-jido-memory-shacl-validator-test
  a jmem:Entity ;
  rdfs:label "ExUnit test module JidoMemory.SHACLValidatorTest" .

#################################################################
# Sources (messages + tooling)
#################################################################

ex:utterance-001
  a jmem:UserUtterance ;
  rdfs:label "User message — implementation preferences" ;
  rdfs:comment "User wants SHACL validation implemented in pure Elixir using RDF.ex graphs." ;
  jmem:createdAt "2026-01-05T11:02:00Z"^^xsd:dateTime .

ex:utterance-002
  a jmem:UserUtterance ;
  rdfs:label "User message — testing requirements" ;
  rdfs:comment "User requests ExUnit tests that validate both valid and invalid graphs." ;
  jmem:createdAt "2026-01-05T11:07:30Z"^^xsd:dateTime .

ex:tool-run-001
  a jmem:ToolInvocation ;
  rdfs:label "Mix task — scan current modules" ;
  rdfs:comment "mix x.list_modules: JidoMemory.Application, JidoMemory.Repo, JidoMemory.GraphLoader" ;
  jmem:createdAt "2026-01-05T11:10:00Z"^^xsd:dateTime .

ex:tool-run-002
  a jmem:ToolInvocation ;
  rdfs:label "File read — lib/jido_memory/shacl_validator.ex" ;
  rdfs:comment "Read current content of JidoMemory.SHACLValidator module" ;
  jmem:createdAt "2026-01-05T11:20:00Z"^^xsd:dateTime .

#################################################################
# Facts (actual coding-related facts)
#################################################################

# Global preference: how the user wants to implement things, long-term relevant.

ex:fact-001
  a jmem:UserPreference ;
  jmem:aboutEntity ex:user-pascal ;
  jmem:inContext ex:global-context ;
  jmem:hasSource ex:utterance-001 ;
  jmem:statementText "User prefers building SHACL and RDF tooling in pure Elixir, using RDF.ex and avoiding NIFs when possible." ;
  jmem:normalizedForm "prefers_pure_elixir_rdf_ex_no_nifs" ;
  jmem:confidence "0.96"^^xsd:decimal ;
  jmem:salience "0.92"^^xsd:decimal ;
  jmem:status "active" ;
  jmem:createdAt "2026-01-05T11:02:15Z"^^xsd:dateTime .

# Task-level constraint: how this specific feature must behave.

ex:fact-002
  a jmem:ConstraintFact ;
  jmem:aboutEntity ex:project-jido-memory ;
  jmem:inContext ex:task-001 ;
  jmem:hasSource ex:utterance-001 ;
  jmem:statementText "The SHACL validation pipeline in JidoMemory must run entirely in pure Elixir and operate on RDF.ex Graph structures." ;
  jmem:normalizedForm "constraint_shacl_pipeline_pure_elixir_rdf_ex_graph" ;
  jmem:confidence "0.90"^^xsd:decimal ;
  jmem:salience "0.82"^^xsd:decimal ;
  jmem:status "active" ;
  jmem:createdAt "2026-01-05T11:06:40Z"^^xsd:dateTime .

# Additional constraint: testing expectations.

ex:fact-003
  a jmem:ConstraintFact ;
  jmem:aboutEntity ex:test-module-jido-memory-shacl-validator-test ;
  jmem:inContext ex:task-001 ;
  jmem:hasSource ex:utterance-002 ;
  jmem:statementText "The test module JidoMemory.SHACLValidatorTest must include tests for both valid and invalid graphs using ExUnit." ;
  jmem:normalizedForm "constraint_tests_valid_and_invalid_graphs_exunit" ;
  jmem:confidence "0.93"^^xsd:decimal ;
  jmem:salience "0.80"^^xsd:decimal ;
  jmem:status "active" ;
  jmem:createdAt "2026-01-05T11:07:45Z"^^xsd:dateTime .

# Tool-derived fact about the current project state (which modules already exist).

ex:fact-004
  a jmem:ToolResultFact ;
  jmem:aboutEntity ex:project-jido-memory ;
  jmem:inContext ex:task-001 ;
  jmem:hasSource ex:tool-run-001 ;
  jmem:statementText "The JidoMemory project currently defines JidoMemory.Application, JidoMemory.Repo, and JidoMemory.GraphLoader, but no SHACLValidator yet." ;
  jmem:confidence "0.91"^^xsd:decimal ;
  jmem:salience "0.65"^^xsd:decimal ;
  jmem:status "active" ;
  jmem:createdAt "2026-01-05T11:10:30Z"^^xsd:dateTime .

# Tool-derived fact about an initial stub module.

ex:fact-005
  a jmem:ToolResultFact ;
  jmem:aboutEntity ex:module-jido-memory-shacl-validator ;
  jmem:inContext ex:task-001 ;
  jmem:hasSource ex:tool-run-002 ;
  jmem:statementText "The JidoMemory.SHACLValidator module currently defines two public functions: validate/2 and load_shapes/1, but validate/2 returns :not_implemented." ;
  jmem:confidence "0.94"^^xsd:decimal ;
  jmem:salience "0.72"^^xsd:decimal ;
  jmem:status "active" ;
  jmem:createdAt "2026-01-05T11:20:25Z"^^xsd:dateTime .

# Plan step fact: a concrete coding task to be executed.

ex:fact-006
  a jmem:PlanStepFact ;
  jmem:aboutEntity ex:module-jido-memory-shacl-validator ;
  jmem:inContext ex:task-001 ;
  jmem:statementText "Implement validate/2 in JidoMemory.SHACLValidator so that it loads SHACL shapes once at startup and validates a given RDF.ex Graph, returning {:ok, report} or {:error, violations}." ;
  jmem:confidence "0.89"^^xsd:decimal ;
  jmem:salience "0.88"^^xsd:decimal ;
  jmem:status "active" ;
  jmem:createdAt "2026-01-05T11:22:00Z"^^xsd:dateTime .

# Derived fact: a design decision combining constraints + current state.

ex:fact-007
  a jmem:DerivedFact ;
  jmem:aboutEntity ex:project-jido-memory ;
  jmem:inContext ex:task-001 ;
  jmem:derivedFrom ex:fact-002 , ex:fact-003 , ex:fact-005 ;
  jmem:statementText "The SHACL pipeline in JidoMemory will use JidoMemory.SHACLValidator.validate/2 on RDF.ex Graphs, with shapes loaded by load_shapes/1, and will be covered by ExUnit tests in JidoMemory.SHACLValidatorTest for both valid and invalid graphs." ;
  jmem:confidence "0.90"^^xsd:decimal ;
  jmem:salience "0.90"^^xsd:decimal ;
  jmem:status "candidate" ;
  jmem:createdAt "2026-01-05T11:25:00Z"^^xsd:dateTime .

